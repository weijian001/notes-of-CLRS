# 15.4 Longest common subsequence

标签： 动态规划 最长公共子序列

---
###笔记
引例，两串DNA，一种衡量相似的的方法：寻找第三个串说S<sub>3</sub>，它所有的碱基也出现在S<sub>1</sub>和S<sub>2</sub>中，**且在三个串中出现的顺序都是相同的，但在S<sub>1</sub>和S<sub>2</sub>中不要求连续出现**。可以找到的S<sub>3</sub>越长，S<sub>1</sub>S<sub>2</sub>相似度越高。

一个给定序列的子序列，就是将给定序列中零个或多个元素去掉之后的结果（子序列在原序列中不一定连续）。  
给定两个序列X和Y，如果Z既是X的子序列也是Y的子序列，我们就称它时X和Y的公共子序列。  
**最长公共子序列LCS**(longest-common-subsequence problem)给定两个序列X=< x<sub>1</sub>, x<sub>2</sub>, .., x<sub>m</sub> > 和 Y=< y<sub>1</sub>, y<sub>2</sub>, .., y<sub>n</sub> >，求X和Y长度的最长公共子序列。

**步骤1：刻画最长公共子序列特征**  
如果用暴力搜索，则穷举X的左右子序列，对每个子序列检查它是否在Y中也是子序列，记录最长的。一个N元素的集合有2<sup>n</sup>的子集，所以这种暴力搜索法的时间复杂度是指数形式的。  
先给出“前缀”的定义：给定一个序列X=< x<sub>1</sub>, x<sub>2</sub>, .., x<sub>m</sub> >，对i=0,1,...,m，定义X的第i前缀为X<sub>i</sub>=< x<sub>1</sub>, x<sub>2</sub>, .., x<sub>i</sub> >。例如X=< A, B, C, B, D>，X<sub>4</sub>=< A, B, C, B>，X<sub>0</sub>为空串。

如下定理所示，LCS问题具有最优子结构性质，子问题的自然分类对应两个输入序列的“前缀”。  
**定理15.1(LCS的最优子结构)**  令X=< x<sub>1</sub>, x<sub>2</sub>, .., x<sub>m</sub> >和Y=< y<sub>1</sub>, y<sub>2</sub>, .., y<sub>n</sub> >为两个序列，Z=< z<sub>1</sub>, z<sub>2</sub>, .., z<sub>k</sub> >为X和Y的任意LCS。  
1. 如果x<sub>m</sub> = y<sub>n</sub>，则x<sub>m</sub> = y<sub>n</sub> = z<sub>k</sub>，且Z<sub>k-1</sub>是X<sub>m-1</sub>和Y<sub>n-1</sub>的一个LCS。  
2. 如果x<sub>m</sub> != y<sub>n</sub>，z<sub>k</sub> != x<sub>m</sub>意味着Z是X<sub>m-1</sub>和Y的一个LCS。  
3. 如果x<sub>m</sub> != y<sub>n</sub>，z<sub>k</sub> != y<sub>n</sub>意味着Z是X和Y<sub>n-1</sub>的一个LCS。  

> 以上情况都可以用反证法证明，由定理可得两个序列的LCS包含两个序列前缀的LCS，因此LCS问题具有最优子结构。




